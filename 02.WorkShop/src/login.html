<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>My Cookbook</title>
    <link rel="stylesheet" href="/JavaScript Applications/Asynchronous Programming/Lab/02.WorkShop/static/site.css">
    <link rel="stylesheet" href="/JavaScript Applications/Asynchronous Programming/Lab/02.WorkShop/static/recipe.css">
    <link rel="stylesheet" href="/JavaScript Applications/Asynchronous Programming/Lab/02.WorkShop/static/form.css">
</head>

<body>
    <header>
        <h1>My Cookbook</h1>
        <nav>
            <a href="index.html">Catalog</a>
            <a class="active">Login</a>
            <a href="register.html">Register</a>
        </nav>
    </header>
    <main>
        <article>
            <h2>Login</h2>
            <form>
                <label>E-mail: <input type="text" name="email"></label>
                <label>Password: <input type="password" name="password"></label>
                <input type="submit" value="Login">
            </form>
        </article>
    </main>
    <script>
        const formElement = document.querySelector(`form`);
        formElement.addEventListener(`submit`, async (e) => {
            e.preventDefault()
            let currentForm = new FormData(e.currentTarget)
            let email = currentForm.get(`email`)
            let password = currentForm.get(`password`)

            fetch(`http://localhost:3030/users/login`, {
                method: `POST`,
                headers: {
                    "content-type": "application/json"
                },
                body: JSON.stringify({

                    email: email,
                    password: password

                }
                )
            }).then(res => res.json()).then(data => {
                console.log(data);
                localStorage.setItem("username", data.username)
                localStorage.setItem("id", data._id)
                localStorage.setItem("accessToken", data.accessToken)


            })
        })

    </script>
</body>

</html>